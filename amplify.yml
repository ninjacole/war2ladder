version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd War2Ladder/Areas/Frontend
        - rm -rf node_modules package-lock.json
        - npm install
    build:
      commands:
        - npm run build
    postBuild:
      commands:
        - pwd
        - ls -la
        - ls -la War2Ladder/Areas/Frontend/ || echo "Frontend dir not found"
        - |
          if [ -d "War2Ladder/Areas/Frontend/public" ]; then
            echo "Copying public files..."
            cp -r War2Ladder/Areas/Frontend/public/* War2Ladder/Areas/Frontend/dist/ || echo "Copy failed"
          else
            echo "Public directory not found"
          fi
  artifacts:
    baseDirectory: War2Ladder/Areas/Frontend/dist
    files:
      - '**/*'
  cache:
    paths:
      - War2Ladder/Areas/Frontend/node_modules/**/*
customHeaders:
  - pattern: '**/*.pud'
    headers:
      - key: 'Content-Type'
        value: 'application/octet-stream'
      - key: 'Cache-Control'
        value: 'public, max-age=31536000'